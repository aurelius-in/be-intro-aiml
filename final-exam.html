<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Final Exam: Introduction to AI and Machine Learning</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <h1>Final Exam: Introduction to AI and Machine Learning</h1>
    </header>
    <main>
        <form id="examForm" onsubmit="return submitExam(event)">
            <div id="questionsContainer"></div>
            <button type="submit">Submit for Grading</button>
        </form>
        <div id="resultMessage"></div>
        <button id="certificateButton" style="display: none;" onclick="redirectToCertificate()">View and Print Certificate</button>
    </main>
    <footer>
        <p>&copy; 2024 Blue Eagle AI and Robotics. All rights reserved.</p>
    </footer>
    <script>
        const questionsUrl = 'questions.json';
        const answersUrl = 'answers.json';
        let correctAnswers = {};

        async function loadQuestions() {
            const response = await fetch(questionsUrl);
            const data = await response.json();
            const questionsContainer = document.getElementById('questionsContainer');

            data.questions.forEach(question => {
                const questionDiv = document.createElement('div');
                questionDiv.classList.add('question');
                questionDiv.innerHTML = `
                    <p>${question.question}</p>
                    <label><input type="radio" name="${question.id}" value="a"> ${question.options.a}</label><br>
                    <label><input type="radio" name="${question.id}" value="b"> ${question.options.b}</label><br>
                    <label><input type="radio" name="${question.id}" value="c"> ${question.options.c}</label><br>
                    <label><input type="radio" name="${question.id}" value="d"> ${question.options.d}</label>
                `;
                questionsContainer.appendChild(questionDiv);
            });
        }

        async function loadAnswers() {
            const response = await fetch(answersUrl);
            const data = await response.json();
            correctAnswers = data.answers;
        }

        async function initializeExam() {
            await loadQuestions();
            await loadAnswers();
        }

        function submitExam(event) {
            event.preventDefault(); // Prevent form submission
            const form = document.getElementById('examForm');
            let score = 0;
            const totalQuestions = Object.keys(correctAnswers).length;

            for (let i = 1; i <= totalQuestions; i++) {
                const questionId = `q${i}`;
                const answer = form[questionId].value;
                if (answer === correctAnswers[questionId]) {
                    score++;
                } else {
                    markIncorrect(questionId);
                }
            }

            const percentage = (score / totalQuestions) * 100;
            const resultMessage = document.getElementById('resultMessage');
            const certificateButton = document.getElementById('certificateButton');

            if (percentage >= 75) {
                resultMessage.textContent = `Congratulations! You scored ${percentage}%. You passed the exam.`;
                resultMessage.style.color = 'green';
                certificateButton.style.display = 'block';
            } else {
                resultMessage.textContent = `You scored ${percentage}%. You need at least 75% to pass.`;
                resultMessage.style.color = 'red';
            }
        }

        function markIncorrect(questionId) {
            const questionElements = document.getElementsByName(questionId);
            questionElements.forEach(element => {
                if (!element.checked) {
                    element.parentElement.style.color = 'red';
                }
            });
        }

        function redirectToCertificate() {
            const name = prompt("Please enter your name for the certificate:");
            if (name) {
                window.location.href = `final-certificate.html?success=true&name=${encodeURIComponent(name)}`;
            }
        }

        document.addEventListener('DOMContentLoaded', initializeExam);
    </script>
</body>
</html>
